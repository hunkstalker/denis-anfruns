---
import BaseLayout from '../layouts/BaseLayout.astro';
import Nav from '../components/Nav.astro';
import Header from '../components/Header.astro';
import SocialLinks from '../components/SocialLinks.astro';
import TopProjects from '../components/TopProjects.astro';
import SeasonalEffect from '../components/SeasonalEffect.svelte';
import KonamiCode from '../components/KonamiCode.svelte';
import MegaManEasterEgg from '../components/MegaManEasterEgg.svelte';
import '../styles/curtain.css';

const siteTitle = `Denis A. M. Portfolio`;
const lang = 'es';
---
<script is:inline>
  const userLang = navigator.language || navigator.userLanguage; 
  const savedLang = localStorage.getItem('selectedLang');

  if (window.location.pathname === '/') {
    // Si hay preferencia guardada, la respetamos
    if (savedLang) {
      if (savedLang === 'ca') {
        window.location.href = '/ca';
      } else if (savedLang === 'en') {
        window.location.href = '/en';
      }
      // Si es 'es', nos quedamos aqu√≠
    } else {
      // Si no hay preferencia, usamos el idioma del navegador
      if (userLang.startsWith('ca')) {
        window.location.href = '/ca';
      } else if (!userLang.startsWith('es')) {
        window.location.href = '/en';
      }
    }
  }
</script>
<BaseLayout siteTitle={siteTitle} lang={lang}>
  <Nav lang={lang} />
  <div class='flex-1 container'>
    <Header lang={lang} />
    <TopProjects lang={lang} />
    <SocialLinks lang={lang} />
  </div>
  
  <!-- üçÇ‚ùÑÔ∏è Seasonal Effect (unlocked by Konami Code) -->
  <SeasonalEffect client:load particleCount={60} speed={0.8} />
  
  <!-- üéÆ Konami Code Easter Egg (Press Space to start) -->
  <KonamiCode client:load />
  
  <!-- ü§ñ Mega Man Easter Egg (Type "MEGAMAN") -->
  <MegaManEasterEgg client:load />
</BaseLayout>