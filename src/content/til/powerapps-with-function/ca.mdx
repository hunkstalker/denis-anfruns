---
title: "Codi més net amb la funció With"
pubDate: 2025-11-15T19:00:00Z
lang: "ca"
---

import CodeTabs from '../../../components/mdx/CodeTabs.astro';
import Callout from '../../../components/mdx/Callout.astro';

Evita crear variables de context temporals o repetir lògica complexa. La funció `With` permet definir variables locals que només existeixen dins del seu àmbit.

<CodeTabs 
  items={[
    { 
      label: 'Power Apps', 
      code: `// ❌ Repetitiu i difícil de llegir
Patch(Usuaris, ThisItem, {
    NomComplet: User().FullName & " (" & User().Email & ")",
    ID_Unic: Upper(User().Email)
});

// ✅ Amb With (Variables locals)
With({ 
    UsuariActual: User() 
},
    Patch(Usuaris, ThisItem, {
        NomComplet: UsuariActual.FullName & " (" & UsuariActual.Email & ")",
        ID_Unic: Upper(UsuariActual.Email)
    })
);`, 
      lang: 'power fx' 
    }
  ]}
/>

<Callout type="warning" title="Compte amb el separador" filled>
  Recorda que si tens Power Apps configurat per a la **regió europea** hauràs de canviar la coma `,` per punt i coma `;` a les fórmules. I doble punt i coma `;;` per als salts de línia on normalment es posaria únicament un punt i coma `;`.
</Callout>

El teu "Jo del futur" t'agrairà aquest codi llegible.
