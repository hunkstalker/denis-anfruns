---
title: Automatic and DRY Metadata System in Astro
lang: en
slug: astro-metadata-system
---
import Callout from '@components/mdx/Callout.astro';

In this TIL we are going to dissect how the metadata management system works in this project. You might have noticed that our Markdown (`.mdx`) files are unusually clean of repetitive frontmatter. This isn't magic, it's engineering (well, maybe a little bit of script magic).

## The Problem: Duplication in i18n

When working with internationalization (i18n) in Astro using *Content Collections*, duplication becomes an issue. Keeping metadata like dates, tags, and images synchronized across multiple files (one per language) violates the DRY (Don't Repeat Yourself) principle and leads to inconsistencies.

## The Solution: Folder Architecture and `meta.json`

Instead of loose files, we use a folder-per-content structure:

```text
src/content/til/astro-metadata-system/
  meta.json   <-- The Single Source of Truth (Common Data)
  es.mdx      <-- Spanish Content
  en.mdx      <-- English Content
  ca.mdx      <-- Catalan Content
```

- **`meta.json`**: Contains language-agnostic data (`pubDate`, `tags`, `heroImage`, etc.).
- **`*.mdx`**: Contains only language-specific content and compilation essentials (`title`, `slug`).

## The Automation

A custom script, `scripts/normalize-content.mjs`, runs automatically via Astro's `astro:config:setup` hook. It:

1.  **Centralizes Data**: Extracts common metadata from content files into `meta.json`.
2.  **Cleans MDX**: Removes redundant frontmatter from `.mdx` files, forcing them to rely on the central `meta.json`.

This ensures that data is always synchronized across all languages.
