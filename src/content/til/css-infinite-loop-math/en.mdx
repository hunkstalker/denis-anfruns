---
title: "Math for a Perfect CSS Infinite Loop"
lang: "en"
---

import CodeTabs from '../../../components/mdx/CodeTabs.astro';

Have you ever tried to create an infinite carousel or gradient and noticed a "jump" at the end? The key to making it imperceptible lies in the math.

### The Problem
Suppose you have a background image that is 4 times larger than your container (`background-size: 400%`) and you want it to scroll, creating an infinite loop.

If your image has a repeating pattern (e.g., `[A, B, A, B]`), and you animate the `background-position` from `0%` to `-100%` (or similar values), you will often see an abrupt cut.

### The Mathematical Solution

For a perfect loop, you need to calculate the exact point where the image becomes identical to the start.

The formula for `background-position` percentage is counterintuitive:
> `(container_width - image_width) * percentage`

For a `background-size: 400%`:
1.  The image measures 4 units. The container measures 1 unit.
2.  We want to move **2 units** (half of the image, assuming we have duplicated the content for the loop).
3.  The total range of possible movement is `4 - 1 = 3` units.
4.  The target percentage is: `2 (desired displacement) / 3 (total range) = 0.6666...`
5.  That is: **66.666%**.

<CodeTabs 
  items={[
    { 
      label: 'CSS', 
      code: `@keyframes gradient-move {
    0% { background-position: 0% 50%; }
    /* The magic number for background-size: 400% */
    100% { background-position: 66.666% 50%; }
}`, 
      lang: 'css' 
    }
  ]}
/>

Using that value, when the animation reaches 100%, the image is visually in the identical position to 0%, making the animation reset invisible.
